# Reglas del Proyecto Velu Mobile

## üìö Archivos de Conocimiento

**IMPORTANTE**: Antes de trabajar en cualquier tarea relacionada con estas tecnolog√≠as, leer los archivos de conocimiento correspondientes en `docs/`:

- **`docs/svelte5-sintaxis.md`**: Todo sobre sintaxis de Svelte 5, runes, props, eventos, estado, snippets, lifecycle
- **`docs/sveltekit-layouts.md`**: C√≥mo manejar layouts y rutas en SvelteKit con Svelte 5
- **`docs/tokens-diseno.md`**: C√≥mo usar tokens de dise√±o (CSS y JavaScript)
- **`docs/pnpm.md`**: Informaci√≥n sobre pnpm (si existe)

**Regla**: Siempre leer estos archivos cuando trabajes con estas tecnolog√≠as. NO buscar informaci√≥n externa si ya est√° documentada aqu√≠.

## Revisi√≥n y Actualizaci√≥n del Proyecto

- **Revisar TODO el proyecto SOLO cuando el usuario incluya `#context` en su mensaje**: 
  - Cuando veas `#context`, esto indica que el usuario quiere hacer cambios significativos y necesita que entiendas el 100% del contexto del proyecto
  - En este caso, revisar la estructura completa del proyecto, archivos clave, y entender el estado actual antes de hacer cambios
  - Actualizar `.cursorrules` si encuentras algo nuevo, deprecado, o que requiera documentaci√≥n durante esta revisi√≥n
- **Si NO hay `#context` en el mensaje**: 
  - NO revisar todo el proyecto
  - Usar el contexto existente y las reglas ya establecidas en `.cursorrules`
  - Trabajar solo con los archivos espec√≠ficos mencionados o necesarios para la tarea
- **Cuando encuentres c√≥digo deprecado o problemas durante cualquier tarea**: 
  - Buscar TODOS los casos similares en el proyecto usando `grep` o `codebase_search`
  - Migrar/actualizar todos los casos encontrados de forma consistente
  - Actualizar los archivos de conocimiento en `docs/` si encuentras nueva informaci√≥n o mejores pr√°cticas
- **Documentar conocimiento nuevo**: Cuando busques informaci√≥n externa (web search, documentaci√≥n, etc.) para resolver algo que no sab√≠as c√≥mo hacer:
  - SIEMPRE agregar esa informaci√≥n al archivo de conocimiento correspondiente en `docs/`
  - Si no existe un archivo apropiado, crear uno nuevo siguiendo el patr√≥n `docs/[tema].md`
  - Incluir ejemplos pr√°cticos de c√≥mo implementarlo correctamente
  - Esto evita tener que buscar la misma informaci√≥n en el futuro
  - Ejemplo: Si buscas c√≥mo manejar layouts de SvelteKit con snippets, documentarlo en `docs/sveltekit-layouts.md`
- **El proyecto est√° generalmente estable**: El usuario controla cu√°ndo necesita una revisi√≥n completa usando `#context`

## Lenguaje y Tecnolog√≠as

- **SOLO JavaScript (JS)**: Este proyecto usa exclusivamente JavaScript (.js), NO TypeScript (.ts)
- **NUNCA crear archivos .ts o .tsx**: Solo usar .js y .svelte
- **SvelteKit**: Framework principal con Svelte 5
- **Capacitor**: Para desarrollo m√≥vil (iOS/Android)
- **Supabase**: Backend y autenticaci√≥n
- **Vercel**: Plataforma de despliegue
- **pnpm**: Gestor de paquetes (NO usar npm)

## Gesti√≥n de Paquetes

- **SIEMPRE usar pnpm**, nunca npm o yarn
- Comandos: `pnpm install`, `pnpm add`, `pnpm run`, etc.
- El proyecto tiene `pnpm-lock.yaml` y `.npmrc` configurado para pnpm

## Variables de Entorno

- Usar `import.meta.env` para variables de entorno p√∫blicas (NO `$env/dynamic/public`)
- Variables p√∫blicas deben tener prefijo `PUBLIC_`
- Configurar en Vercel: `PUBLIC_SUPABASE_URL` y `PUBLIC_SUPABASE_ANON_KEY`

## Estructura del Proyecto

- **Atomic Design**: atoms ‚Üí molecules ‚Üí organisms ‚Üí templates
- Componentes en `src/lib/components/`
- Servicios en `src/lib/services/` (ej: supabase.js)
- Tokens de dise√±o en `src/lib/tokens/`
- Rutas en `src/routes/`
- **Documentaci√≥n**: Todos los archivos `.md` y documentaci√≥n deben ir en la carpeta `docs/`
- **Archivos de conocimiento**: Los archivos de conocimiento t√©cnico est√°n en `docs/` con nombres descriptivos (ej: `svelte5-sintaxis.md`, `tokens-diseno.md`)

## Configuraci√≥n

- **jsconfig.json**: Configuraci√≥n de JavaScript (NO tsconfig.json)
- **eslint.config.js**: Sin referencias a TypeScript
- **vite.config.js**: Configuraci√≥n de Vite
- **svelte.config.js**: Configuraci√≥n de SvelteKit con adapter-vercel
- **SSR desactivado**: El proyecto usa solo Client-Side Rendering (CSR) para evitar carga en el servidor. Configurado en `src/routes/+layout.js` con `export const ssr = false`

## Convenciones

- Archivos de componentes: PascalCase (ej: `Button.svelte`)
- Variables: camelCase
- Constantes: UPPER_SNAKE_CASE
- Usar alias: `$lib/*`, `$tokens`

## Documentaci√≥n

- **TODOS los archivos `.md` deben ir en la carpeta `docs/`**
- NO crear archivos `.md` en la ra√≠z del proyecto (excepto README.md y CONTRIBUTING.md que son est√°ndar)
- Cualquier documentaci√≥n adicional debe estar en `docs/`
- Los archivos de conocimiento t√©cnico deben seguir el patr√≥n `docs/[tema].md`

## Commits (Conventional Commits)

- **SIEMPRE usar formato Conventional Commits**: `tipo(alcance): descripci√≥n breve`
- **Formato completo**:
  ```
  tipo(alcance): descripci√≥n breve
  
  Descripci√≥n detallada opcional (puede tener m√∫ltiples l√≠neas)
  explicando el qu√© y el por qu√© del cambio.
  
  - Lista de cambios espec√≠ficos
  - Cada cambio en una l√≠nea con gui√≥n
  - Usar vi√±etas para m√∫ltiples cambios relacionados
  
  BREAKING CHANGE: descripci√≥n si hay cambios incompatibles
  ```

### Tipos de Commit

- **`feat`**: Nueva funcionalidad
  ```
  feat(auth): agregar login con Google OAuth
  ```

- **`fix`**: Correcci√≥n de bugs
  ```
  fix(button): corregir estilo disabled en modo oscuro
  ```

- **`refactor`**: Refactorizaci√≥n de c√≥digo sin cambiar funcionalidad
  ```
  refactor(components): migrar a sintaxis Svelte 5
  ```

- **`docs`**: Cambios en documentaci√≥n
  ```
  docs(readme): actualizar instrucciones de instalaci√≥n
  ```

- **`style`**: Cambios de formato, espacios, punto y coma, etc. (no afecta funcionalidad)
  ```
  style(button): corregir indentaci√≥n
  ```

- **`test`**: Agregar o modificar tests
  ```
  test(utils): agregar tests para funci√≥n formatDate
  ```

- **`chore`**: Tareas de mantenimiento, dependencias, build, etc.
  ```
  chore(deps): actualizar svelte a versi√≥n 5.45.5
  ```

- **`perf`**: Mejoras de rendimiento
  ```
  perf(components): optimizar renderizado de lista grande
  ```

- **`ci`**: Cambios en configuraci√≥n de CI/CD
  ```
  ci(github): agregar workflow de tests autom√°ticos
  ```

### Alcance (Scope)

- Opcional pero recomendado
- Indica qu√© parte del c√≥digo afecta
- Ejemplos: `auth`, `components`, `layout`, `tokens`, `docs`, `deps`

### Ejemplos de Commits Correctos

```
feat(auth): agregar autenticaci√≥n con Supabase

- Implementar login con email/password
- Agregar registro de usuarios
- Crear componente LoginForm
- Integrar con Supabase client

BREAKING CHANGE: Requiere variables PUBLIC_SUPABASE_URL y PUBLIC_SUPABASE_ANON_KEY
```

```
fix(button): corregir estado disabled en modo oscuro

El bot√≥n no mostraba correctamente el estado disabled cuando
el tema oscuro estaba activo. Ahora usa var(--opacity-disabled)
correctamente.
```

```
refactor(docs): reorganizar documentaci√≥n en archivos separados

- Separar conocimiento t√©cnico en docs/
- Crear docs/svelte5-sintaxis.md
- Crear docs/sveltekit-layouts.md
- Limpiar .cursorrules dejando solo reglas
```

```
chore(deps): actualizar dependencias

- svelte: 5.40.0 -> 5.45.5
- @capacitor/core: 5.0.0 -> 5.5.0
- pnpm: 8.0.0 -> 9.0.0
```

### Reglas Importantes

1. **Primera l√≠nea**: M√°ximo 72 caracteres, imperativo, sin punto final
2. **Cuerpo**: Separado por l√≠nea en blanco, explicar el qu√© y por qu√©
3. **Vi√±etas**: Usar `-` para listar cambios espec√≠ficos
4. **BREAKING CHANGE**: Solo si hay cambios incompatibles, debe empezar con `BREAKING CHANGE:`
5. **Alcance**: Usar nombres descriptivos y consistentes
6. **Tipo**: Elegir el tipo m√°s apropiado seg√∫n el cambio

### Cu√°ndo Usar Cada Tipo

- **`feat`**: Nueva funcionalidad visible al usuario
- **`fix`**: Correcci√≥n de comportamiento incorrecto
- **`refactor`**: Mejora de c√≥digo sin cambiar funcionalidad
- **`docs`**: Solo cambios en documentaci√≥n/comentarios
- **`chore`**: Mantenimiento, dependencias, configuraci√≥n
- **`style`**: Solo formato (espacios, indentaci√≥n, etc.)
- **`test`**: Solo tests
- **`perf`**: Mejoras de rendimiento
- **`ci`**: Configuraci√≥n de CI/CD

## Al crear c√≥digo nuevo

1. SIEMPRE usar JavaScript (.js), nunca TypeScript
2. Usar `import.meta.env` para variables de entorno
3. Usar pnpm para instalar dependencias
4. Seguir Atomic Design para componentes
5. Siempre usar los componentes del atomic design sin modificarlos a menos que sea necesario para cumplir con la peticion, pero si no existe el componente se puede crear dentro del atomic design y recien usarlo.
6. Usar los alias definidos en svelte.config.js
7. Crear documentaci√≥n en `docs/` si es necesario
8. **SIEMPRE usar sintaxis moderna de Svelte 5**: Ver `docs/svelte5-sintaxis.md` para detalles completos
9. **NUNCA usar sintaxis legacy**: Ver `docs/svelte5-sintaxis.md` para lista completa de sintaxis deprecada
10. **Para layouts de SvelteKit**: Ver `docs/sveltekit-layouts.md` para la forma correcta de implementarlos
11. **Para tokens de dise√±o**: Ver `docs/tokens-diseno.md` para c√≥mo usarlos correctamente

## Resumen de Sintaxis Svelte 5

**Referencia completa**: Ver `docs/svelte5-sintaxis.md`

**SIEMPRE usar**:
- `$props()` para props
- `onclick`, `onsubmit`, etc. para eventos
- `$state()` para estado reactivo
- `$derived()` para valores derivados
- `$effect()` para efectos reactivos
- `{@render children?.()}` para snippets (NUNCA `<slot />`)

**NUNCA usar** (legacy deprecado):
- `export let` para props
- `on:click`, `on:submit` para eventos
- `$:` para reactive statements
- `beforeUpdate`, `afterUpdate` para lifecycle
- `createEventDispatcher` para eventos
- `<slot />` para contenido hijo
